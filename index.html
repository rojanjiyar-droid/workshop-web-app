const users = [
    { username: 'admin', password: '1234', role: 'admin', name: 'مدیر سیستم' },
    { username: 'accountant', password: '5678', role: 'accountant', name: 'حسابدار' },
    { username: 'operator', password: '91011', role: 'operator', name: 'اپراتور' }
];

let currentUser = null;

function login() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    
    const user = users.find(u => u.username === username && u.password === password);
    
    if (user) {
        currentUser = user;
        document.getElementById('loginPage').style.display = 'none';
        document.getElementById('mainPage').style.display = 'block';
        document.getElementById('currentUser').textContent = user.name;
        
        // تنظیم دسترسی‌ها بر اساس نقش
        setUserPermissions(user.role);
        
        loadAllData();
        initDatePickers();
        updateDashboard();
        showAlert(`خوش آمدید ${user.name}`, 'success');
    } else {
        showAlert('نام کاربری یا رمز عبور اشتباه است!', 'error');
    }
}

function setUserPermissions(role) {
    const adminOnlyButtons = document.querySelectorAll('.admin-only');
    const accountantButtons = document.querySelectorAll('.accountant-only');
    
    if (role === 'operator') {
        adminOnlyButtons.forEach(btn => btn.style.display = 'none');
        accountantButtons.forEach(btn => btn.style.display = 'none');
    } else if (role === 'accountant') {
        adminOnlyButtons.forEach(btn => btn.style.display = 'none');
    }
}
