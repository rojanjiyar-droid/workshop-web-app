<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ­ Ú©Ù„Ø´ÛŒÙÙˆÙ… - Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ v3.1</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<style>
* {margin:0;padding:0;box-sizing:border-box}
body {font-family:'Tahoma',Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:#2c3e50;line-height:1.6;padding:10px;direction:rtl}
.container {max-width:100%;margin:0 auto}
.login-container {display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px}
.login-card {background:#f8f9fa;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.2);padding:40px;width:100%;max-width:400px;text-align:center}
.logo {width:80px;height:80px;margin:0 auto 20px;background:linear-gradient(135deg,#3498db,#2980b9);border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:28px;font-weight:bold}
.form-control {width:100%;padding:16px;border:2px solid #e0e0e0;border-radius:12px;font-size:16px;transition:all 0.3s;font-family:inherit;margin-bottom:15px}
.form-control:focus {border-color:#3498db;outline:none;box-shadow:0 0 0 3px rgba(52,152,219,0.1)}
.btn {display:inline-flex;align-items:center;justify-content:center;padding:16px 32px;border:none;border-radius:12px;font-size:16px;font-weight:500;cursor:pointer;transition:all 0.3s;background:#27ae60;color:white;width:100%;margin-top:20px}
.btn:hover {opacity:0.95;transform:translateY(-2px)}
.btn:disabled {opacity:0.6;cursor:not-allowed}
.main-container {background:#f8f9fa;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.2);overflow:hidden;min-height:calc(100vh - 40px);margin:20px auto;max-width:1400px;display:none}
.main-header {background:linear-gradient(135deg,#2c3e50,#34495e);color:white;padding:20px;display:flex;justify-content:space-between;align-items:center}
.nav-btn {background:none;border:none;color:white;padding:16px 20px;cursor:pointer;font-size:14px;display:flex;align-items:center;gap:8px}
.nav-btn:hover,.nav-btn.active {background:#3498db}
.content-area {padding:25px}
.card {background:white;border-radius:15px;padding:25px;margin-bottom:25px;border-right:4px solid #3498db;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
.stats-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:25px}
.stat-card {background:linear-gradient(135deg,#3498db,#2980b9);color:white;padding:25px;border-radius:15px;text-align:center}
.notification {position:fixed;top:25px;right:25px;background:#27ae60;color:white;padding:20px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.2);z-index:10000;max-width:350px}
@media (max-width:768px) {.main-header {flex-direction:column;text-align:center;gap:15px}}
</style>
</head>
<body>

<!-- Ù„Ø§Ú¯ÛŒÙ† Ø³Ø§Ø¯Ù‡ -->
<div class="login-container" id="loginPage">
  <div class="login-card">
    <div class="logo">CF</div>
    <h1 style="margin-bottom:30px;color:#2c3e50">ğŸ­ Ú©Ù„Ø´ÛŒÙÙˆÙ… v3.1</h1>
    <input type="text" id="username" class="form-control" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ" value="admin">
    <input type="password" id="password" class="form-control" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
    <button class="btn" onclick="simpleLogin()">ğŸš€ ÙˆØ±ÙˆØ¯</button>
    <div style="margin-top:20px;font-size:14px;color:#666">
      <strong>admin / 1234</strong>
    </div>
  </div>
</div>

<!-- Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§ØµÙ„ÛŒ -->
<div class="main-container" id="mainApp">
  <header class="main-header">
    <div>
      <h2 style="margin:0">ğŸ­ Ú©Ù„Ø´ÛŒÙÙˆÙ…</h2>
      <div id="currentDate"></div>
    </div>
    <div>
      <span id="welcomeUser"></span>
      <button class="btn" onclick="logout()" style="padding:10px 20px;font-size:14px;width:auto;margin:0">Ø®Ø±ÙˆØ¬</button>
    </div>
  </header>

  <nav style="background:#34495e;display:flex;overflow-x:auto">
    <button class="nav-btn active" onclick="showPage('dashboard')">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</button>
    <button class="nav-btn" onclick="showPage('contracts')">ğŸ“‹ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§</button>
    <button class="nav-btn" onclick="showPage('checks')">ğŸ’³ Ú†Ú©â€ŒÙ‡Ø§</button>
    <button class="nav-btn" onclick="showPage('backup')">â˜ï¸ Ù¾Ø´ØªÛŒØ¨Ø§Ù†</button>
  </nav>

  <main class="content-area" id="contentArea">
    <div id="dashboard" class="page active">
      <div class="card">
        <h3 style="margin-bottom:20px;color:#2c3e50">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</h3>
        <div class="stats-grid" id="stats"></div>
        <div style="margin-top:30px">
          <button class="btn" onclick="backupData()" style="width:auto;padding:12px 24px">ğŸ’¾ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ</button>
          <button class="btn" onclick="exportExcel()" style="width:auto;padding:12px 24px;background:#e74c3c">ğŸ“Š Ø§Ú©Ø³Ù„</button>
        </div>
      </div>
    </div>
    
    <div id="contracts" class="page" style="display:none">
      <div class="card">
        <h3 style="margin-bottom:20px;color:#2c3e50">ğŸ“‹ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§</h3>
        <div id="contractsList"></div>
        <button class="btn" onclick="addContract()" style="width:auto;padding:12px 24px;margin-top:20px">â• Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø¬Ø¯ÛŒØ¯</button>
      </div>
    </div>
    
    <div id="checks" class="page" style="display:none">
      <div class="card">
        <h3 style="margin-bottom:20px;color:#2c3e50">ğŸ’³ Ú†Ú©â€ŒÙ‡Ø§</h3>
        <div id="checksList"></div>
        <button class="btn" onclick="addCheck()" style="width:auto;padding:12px 24px;margin-top:20px">â• Ú†Ú© Ø¬Ø¯ÛŒØ¯</button>
      </div>
    </div>
    
    <div id="backup" class="page" style="display:none">
      <div class="card">
        <h3 style="margin-bottom:20px;color:#2c3e50">â˜ï¸ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ</h3>
        <button class="btn" onclick="downloadBackup()">ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ JSON</button>
        <input type="file" id="backupFile" accept=".json" style="display:none">
        <button class="btn" onclick="document.getElementById('backupFile').click()" style="background:#9b59b6">ğŸ“¤ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ</button>
      </div>
    </div>
  </main>
</div>

<script>
// ğŸ’¾ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
let appData = JSON.parse(localStorage.getItem('kaleshiData')) || {
  contracts: [],
  checks: [],
  version: '3.1'
};

// ğŸ”‘ Ù„Ø§Ú¯ÛŒÙ† Ø³Ø§Ø¯Ù‡
function simpleLogin() {
  const user = document.getElementById('username').value;
  const pass = document.getElementById('password').value;
  
  if (user === 'admin' && pass === '1234') {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('mainApp').style.display = 'block';
    document.getElementById('welcomeUser').textContent = 'Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ admin';
    updateDate();
    loadDashboard();
    saveData();
  } else {
    alert('âŒ Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡!\nadmin / 1234');
  }
}

// ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡
function saveData() {
  localStorage.setItem('kaleshiData', JSON.stringify(appData));
}

// ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
function loadDashboard() {
  document.getElementById('stats').innerHTML = `
    <div class="stat-card">
      <div style="font-size:32px;font-weight:bold">${appData.contracts.length}</div>
      <div>Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯</div>
    </div>
    <div class="stat-card">
      <div style="font-size:32px;font-weight:bold">${appData.checks.length}</div>
      <div>Ú†Ú©</div>
    </div>
  `;
  loadContractsList();
  loadChecksList();
}

// ğŸ“‹ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§
function loadContractsList() {
  const list = document.getElementById('contractsList');
  list.innerHTML = appData.contracts.map(c => `
    <div style="padding:15px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center">
      <div>
        <strong>${c.customer || 'Ù…Ø´ØªØ±ÛŒ'}</strong> - ${c.amount || 0} ØªÙˆÙ…Ø§Ù†
        <br><small>${c.date || ''}</small>
      </div>
      <div>
        <button class="btn" onclick="editContract('${c.id}')" style="padding:8px 16px;font-size:12px">ÙˆÛŒØ±Ø§ÛŒØ´</button>
        <button class="btn" onclick="deleteContract('${c.id}')" style="padding:8px 16px;font-size:12px;background:#e74c3c">Ø­Ø°Ù</button>
      </div>
    </div>
  `).join('') || '<p>Ù‡ÛŒÚ† Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ÛŒ Ù†ÛŒØ³Øª</p>';
}

function addContract() {
  const customer = prompt('Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ:');
  const amount = prompt('Ù…Ø¨Ù„Øº:');
  if (customer && amount) {
    appData.contracts.push({
      id: Date.now(),
      customer,
      amount: parseInt(amount),
      date: new Date().toLocaleDateString('fa-IR')
    });
    saveData();
    loadContractsList();
    loadDashboard();
  }
}

// ğŸ’³ Ú†Ú©â€ŒÙ‡Ø§
function loadChecksList() {
  const list = document.getElementById('checksList');
  list.innerHTML = appData.checks.map(c => `
    <div style="padding:15px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center">
      <div>
        <strong>${c.number || 'Ø´Ù…Ø§Ø±Ù‡'}</strong> - ${c.amount || 0} ØªÙˆÙ…Ø§Ù†
        <br><small>${c.bank || ''} | ${c.dueDate || ''} | ${c.status || 'Ø¬Ø§Ø±ÛŒ'}</small>
      </div>
      <div>
        <button class="btn" onclick="editCheck('${c.id}')" style="padding:8px 16px;font-size:12px">ÙˆÛŒØ±Ø§ÛŒØ´</button>
        <button class="btn" onclick="deleteCheck('${c.id}')" style="padding:8px 16px;font-size:12px;background:#e74c3c">Ø­Ø°Ù</button>
      </div>
    </div>
  `).join('') || '<p>Ù‡ÛŒÚ† Ú†Ú©ÛŒ Ù†ÛŒØ³Øª</p>';
}

function addCheck() {
  const number = prompt('Ø´Ù…Ø§Ø±Ù‡ Ú†Ú©:');
  const amount = prompt('Ù…Ø¨Ù„Øº:');
  const bank = prompt('Ø¨Ø§Ù†Ú©:');
  const dueDate = prompt('Ø³Ø±Ø±Ø³ÛŒØ¯ (1404/01/01):');
  if (number && amount) {
    appData.checks.push({
      id: Date.now(),
      number,
      amount: parseInt(amount),
      bank,
      dueDate,
      status: 'Ø¬Ø§Ø±ÛŒ'
    });
    saveData();
    loadChecksList();
    loadDashboard();
  }
}

// â˜ï¸ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
function downloadBackup() {
  const dataStr = JSON.stringify(appData, null, 2);
  const dataBlob = new Blob([dataStr], {type: 'application/json'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(dataBlob);
  link.download = 'kaleshi-backup.json';
  link.click();
}

document.getElementById('backupFile').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      appData = JSON.parse(e.target.result);
      saveData();
      loadDashboard();
      alert('âœ… Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯');
    };
    reader.readAsText(file);
  }
});

function exportExcel() {
  alert('ğŸ“Š Ø§Ú©Ø³Ù„ Ø¢Ù…Ø§Ø¯Ù‡ - Ø¨Ø²ÙˆØ¯ÛŒ');
}

// ğŸ—‘ï¸ Ø­Ø°Ù
function deleteContract(id) {
  if (confirm('Ø­Ø°ÙØŸ')) {
    appData.contracts = appData.contracts.filter(c => c.id != id);
    saveData();
    loadContractsList();
    loadDashboard();
  }
}

function deleteCheck(id) {
  if (confirm('Ø­Ø°ÙØŸ')) {
    appData.checks = appData.checks.filter(c => c.id != id);
    saveData();
    loadChecksList();
    loadDashboard();
  }
}

// ğŸ“… ØªØ§Ø±ÛŒØ®
function updateDate() {
  document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fa-IR');
}

// ğŸ”„ ØµÙØ­Ø§Øª
function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(pageId).style.display = 'block';
  event.target.classList.add('active');
}

// ğŸšª Ø®Ø±ÙˆØ¬
function logout() {
  location.reload();
}

// Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ
updateDate();
setInterval(updateDate, 60000);
</script>

</body>
</html>
